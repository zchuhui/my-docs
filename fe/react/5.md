# ä½¿ç”¨ Hooks æ›¿ä»£é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰


### ğŸ”„ **ä¼ ç»Ÿé«˜é˜¶ç»„ä»¶ vs Hooks æ–¹æ¡ˆå¯¹æ¯”**
#### åœºæ™¯ï¼šç”¨æˆ·ç™»å½•çŠ¶æ€éªŒè¯

---

### 1ï¸âƒ£ **ä¼ ç»Ÿé«˜é˜¶ç»„ä»¶å®ç°**
```jsx
// é«˜é˜¶ç»„ä»¶ï¼šæ£€æŸ¥ç™»å½•çŠ¶æ€
function withAuth(WrappedComponent) {
  return function AuthWrapper(props) {
    const [isLoggedIn, setIsLoggedIn] = useState(false);

    useEffect(() => {
      checkLogin().then(status => setIsLoggedIn(status));
    }, []);

    return isLoggedIn 
      ? <WrappedComponent {...props} />
      : <Redirect to="/login" />;
  };
}

// ä½¿ç”¨æ–¹å¼
const PrivatePage = withAuth(PageComponent);
```

---

### 2ï¸âƒ£ **Hooks æ›¿ä»£æ–¹æ¡ˆ**
```jsx
// è‡ªå®šä¹‰ Hookï¼šå°è£…ç™»å½•éªŒè¯é€»è¾‘
function useAuth() {
  const [isLoggedIn, setIsLoggedIn] = useState(false);

  useEffect(() => {
    checkLogin().then(status => setIsLoggedIn(status));
  }, []);

  return isLoggedIn;
}

// ç›´æ¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
function PrivatePage() {
  const isLoggedIn = useAuth();

  return isLoggedIn 
    ? <PageComponent />
    : <Redirect to="/login" />;
}
```

---

### ğŸŒŸ **Hooks æ›¿ä»£é«˜é˜¶ç»„ä»¶çš„å…³é”®æ­¥éª¤**
1. **é€»è¾‘æå–**ï¼šå°† HOC ä¸­çš„é€»è¾‘ç§»å…¥è‡ªå®šä¹‰ Hookï¼ˆå¦‚ `useAuth`ï¼‰
2. **çŠ¶æ€ç®¡ç†**ï¼šç”¨ `useState`/`useEffect` æ›¿ä»£ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ
3. **ç›´æ¥è°ƒç”¨**ï¼šåœ¨ç›®æ ‡ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨ Hookï¼Œè€ŒéåŒ…è£¹ç»„ä»¶

---

### ğŸ“ **æ›´å¤šåœºæ™¯è½¬æ¢ç¤ºä¾‹**
#### åœºæ™¯1ï¼šæ•°æ®è¯·æ±‚å°è£…
```jsx
// ä¼ ç»Ÿ HOC
function withData(url) {
  return WrappedComponent => {
    return class extends React.Component {
      state = { data: null, loading: true }

      componentDidMount() {
        fetch(url)
          .then(res => res.json())
          .then(data => this.setState({ data, loading: false }));
      }

      render() {
        return <WrappedComponent data={this.state.data} {...this.props} />;
      }
    }
  }
}

// Hooks æ–¹æ¡ˆ
function useFetch(url) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetch(url)
      .then(res => res.json())
      .then(data => {
        setData(data);
        setLoading(false);
      });
  }, [url]);

  return { data, loading };
}

// ä½¿ç”¨
function UserList() {
  const { data, loading } = useFetch('/api/users');
  return loading ? <Loading /> : <List data={data} />;
}
```

---

#### åœºæ™¯2ï¼šå…¨å±€æ ·å¼æ³¨å…¥
```jsx
// ä¼ ç»Ÿ HOC
function withTheme(WrappedComponent) {
  return function ThemedComponent(props) {
    const theme = useContext(ThemeContext);
    return <WrappedComponent theme={theme} {...props} />;
  }
}

// Hooks æ–¹æ¡ˆ
function useTheme() {
  return useContext(ThemeContext);
}

// ä½¿ç”¨
function Button() {
  const theme = useTheme();
  return <button style={{ color: theme.primary }}>Click me</button>;
}
```

---

### ğŸ“Œ **ä¸ºä»€ä¹ˆæ¨è Hooks æ›¿ä»£ HOCï¼Ÿ**
| ç»´åº¦                | é«˜é˜¶ç»„ä»¶ (HOC)                        | Hooks æ–¹æ¡ˆ                          |
|---------------------|--------------------------------------|------------------------------------|
| **ä»£ç ç»“æ„**         | åµŒå¥—ç»„ä»¶ (`withA(withB(Component))`) | æ‰å¹³åŒ–ç»“æ„ï¼Œæ— åµŒå¥—                  |
| **é€»è¾‘å¤ç”¨**         | é€šè¿‡ç»„ä»¶åŒ…è£¹                         | ç›´æ¥è°ƒç”¨ Hook                      |
| **props å‘½åå†²çª**   | å®¹æ˜“å‘ç”Ÿ                             | æ— å†²çªé£é™©                        |
| **è°ƒè¯•éš¾åº¦**         | ç»„ä»¶æ ‘å±‚çº§æ·±ï¼Œéš¾è·Ÿè¸ª                 | æ›´æ¸…æ™°çš„ç»„ä»¶ç»“æ„                  |
| **TypeScript æ”¯æŒ**  | ç±»å‹å®šä¹‰å¤æ‚                         | ç±»å‹æ¨æ–­æ›´ç®€å•                    |
| **æ€§èƒ½ä¼˜åŒ–**         | éœ€è¦å¤„ç† shouldComponentUpdate       | å¤©ç„¶æ”¯æŒ memo + useMemo/useCallback |

---

### ğŸ›  **è½¬æ¢ç­–ç•¥**
1. **è¯†åˆ«é‡å¤é€»è¾‘**ï¼šæ‰¾å‡ºå¤šä¸ªç»„ä»¶å…±äº«çš„åŠŸèƒ½ï¼ˆå¦‚æ•°æ®è·å–ã€æƒé™éªŒè¯ï¼‰
2. **åˆ›å»ºè‡ªå®šä¹‰ Hook**ï¼šå°†å…±äº«é€»è¾‘æå–ä¸º `useXxx` å‡½æ•°
3. **æ›¿æ¢åŒ…è£¹ç»“æ„**ï¼šåˆ é™¤ HOC åŒ…è£¹å±‚ï¼Œç›´æ¥åœ¨ç»„ä»¶å†…è°ƒç”¨ Hook
4. **å¤„ç†ä¾èµ–é¡¹**ï¼šç”¨ `useEffect` çš„ä¾èµ–æ•°ç»„æ›¿ä»£ç”Ÿå‘½å‘¨æœŸç›‘å¬

---

### ğŸ’¡ **è¿›é˜¶æŠ€å·§ï¼šç»„åˆ Hooks**
```jsx
function Dashboard() {
  // ç»„åˆå¤šä¸ª Hook å®ç°å¤æ‚é€»è¾‘
  const user = useUser();
  const notifications = useNotifications(user.id);
  const theme = useTheme();

  return (
    <div style={{ background: theme.background }}>
      <Header user={user} />
      <NotificationList data={notifications} />
    </div>
  );
}
```

---

### âš ï¸ **æ³¨æ„äº‹é¡¹**
1. **ä¸è¦ç ´å Hook è§„åˆ™**ï¼šå§‹ç»ˆåœ¨ç»„ä»¶é¡¶å±‚ä½¿ç”¨ Hook
2. **åˆç†æ‹†åˆ†é€»è¾‘**ï¼šæ¯ä¸ª Hook åº”èšç„¦å•ä¸€åŠŸèƒ½
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šå¯¹æ˜‚è´µçš„è®¡ç®—ä½¿ç”¨ `useMemo`/`useCallback`
4. **å‘½åè§„èŒƒ**ï¼šè‡ªå®šä¹‰ Hook å¿…é¡»ä»¥ `use` å¼€å¤´

---

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‚¨å¯ä»¥ç”¨æ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤çš„ Hooks æ–¹æ¡ˆå–ä»£ä¼ ç»Ÿé«˜é˜¶ç»„ä»¶ï¼ŒåŒæ—¶ä¿æŒç”šè‡³æå‡ä»£ç çš„å¯è¯»æ€§å’Œå¤ç”¨æ€§ã€‚