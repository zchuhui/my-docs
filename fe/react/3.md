# Hooks è¯­æ³•ä¸ä½¿ç”¨


### 1ï¸âƒ£ **useState - çŠ¶æ€ç®¡ç†**
- **ä½œç”¨**ï¼šè®©å‡½æ•°ç»„ä»¶æ‹¥æœ‰çŠ¶æ€ï¼ˆç±»ä¼¼ç±»ç»„ä»¶çš„ `this.state`ï¼‰
- **åœºæ™¯**ï¼šæŒ‰é’®è®¡æ•°å™¨ã€è¡¨å•è¾“å…¥æ§åˆ¶ç­‰éœ€è¦å­˜å‚¨æ•°æ®å˜åŒ–çš„åœºæ™¯
```jsx
const [count, setCount] = useState(0); // åˆå§‹å€¼0
```

---

### 2ï¸âƒ£ **useEffect - å‰¯ä½œç”¨å¤„ç†**
- **ä½œç”¨**ï¼šå¤„ç†å‰¯ä½œç”¨ï¼ˆç½‘ç»œè¯·æ±‚ã€DOMæ“ä½œã€è®¢é˜…äº‹ä»¶ï¼‰
- **åœºæ™¯**ï¼šæ•°æ®è·å–ã€å®šæ—¶å™¨ã€ç›‘å¬çª—å£å¤§å°
```jsx
useEffect(() => {
  // ç»„ä»¶æŒ‚è½½/æ›´æ–°æ—¶æ‰§è¡Œï¼ˆç±»ä¼¼ componentDidMount + componentDidUpdateï¼‰
  fetchData();
  
  return () => {
    // ç»„ä»¶å¸è½½æ—¶æ¸…ç†ï¼ˆç±»ä¼¼ componentWillUnmountï¼‰
    clearTimeout(timer);
  };
}, [dependency]); // ä¾èµ–é¡¹å˜åŒ–æ—¶é‡æ–°æ‰§è¡Œ
```

---

### 3ï¸âƒ£ **useContext - è·¨ç»„ä»¶ä¼ å€¼**
- **ä½œç”¨**ï¼šæ— éœ€é€å±‚ä¼ é€’ propsï¼Œç›´æ¥è¯»å– Context å€¼
- **åœºæ™¯**ï¼šä¸»é¢˜åˆ‡æ¢ã€ç”¨æˆ·ç™»å½•çŠ¶æ€å…¨å±€å…±äº«
```jsx
import { createContext, useContext } from 'react';

// 1. åˆ›å»º Context
const ThemeContext = createContext('light');

function App() {
  return (
    <ThemeContext.Provider value="dark">
      <Toolbar />
    </ThemeContext.Provider>
  );
}

function Toolbar() {
  const theme = useContext(ThemeContext); // 2. è·å– Context å€¼
  return <div>Current Theme: {theme}</div>;
}
```

---

### 4ï¸âƒ£ **useReducer - å¤æ‚çŠ¶æ€ç®¡ç†**
- **ä½œç”¨**ï¼šç”¨ Redux é£æ ¼ç®¡ç†å¤æ‚çŠ¶æ€é€»è¾‘
- **åœºæ™¯**ï¼šè´­ç‰©è½¦çŠ¶æ€ã€å¤šæ­¥éª¤è¡¨å•
```jsx
import { useReducer } from 'react';

// å®šä¹‰ reducer
function counterReducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 };
    case 'decrement':
      return { count: state.count - 1 };
    default:
      throw new Error();
  }
}

function Counter() {
  const [state, dispatch] = useReducer(counterReducer, { count: 0 });

  return (
    <>
      Count: {state.count}
      <button onClick={() => dispatch({ type: 'increment' })}>+</button>
      <button onClick={() => dispatch({ type: 'decrement' })}>-</button>
    </>
  );
}
```

---

### 5ï¸âƒ£ **useCallback - ç¼“å­˜å‡½æ•°**
- **ä½œç”¨**ï¼šé¿å…å­ç»„ä»¶å› å‡½æ•°å¼•ç”¨å˜åŒ–å¯¼è‡´çš„æ— æ•ˆé‡æ¸²æŸ“
- **åœºæ™¯**ï¼šå°†å‡½æ•°ä½œä¸º props ä¼ é€’ç»™å­ç»„ä»¶æ—¶
```jsx
import { useCallback } from 'react';

function App() {
  const memoizedCallback = useCallback(() => {
    console.log('å‡½æ•°è¢«ç¼“å­˜äº†ï¼Œä¾èµ–é¡¹ä¸å˜å°±ä¸ä¼šé‡æ–°åˆ›å»º');
  }, [/* ä¾èµ–é¡¹æ•°ç»„ */]);

  return <ChildComponent onClick={memoizedCallback} />;
}
```

---

### 6ï¸âƒ£ **useMemo - ç¼“å­˜è®¡ç®—ç»“æœ**
- **ä½œç”¨**ï¼šé¿å…é‡å¤æ‰§è¡Œå¤æ‚è®¡ç®—ï¼Œä¼˜åŒ–æ€§èƒ½
- **åœºæ™¯**ï¼šå¤§æ•°æ®é‡è¿‡æ»¤ã€å¤æ‚æ•°å­¦è¿ç®—
```jsx
import { useMemo } from 'react';

function ExpensiveComponent({ a, b }) {
  const result = useMemo(() => {
    return a * b; // åªæœ‰ a æˆ– b å˜åŒ–æ—¶æ‰ä¼šé‡æ–°è®¡ç®—
  }, [a, b]);

  return <div>Result: {result}</div>;
}
```

---

### 7ï¸âƒ£ **useRef - å¼•ç”¨ DOM/ä¿å­˜å¯å˜å€¼**
- **ä½œç”¨**ï¼šè·å– DOM å…ƒç´ å¼•ç”¨ æˆ– ä¿å­˜ä¸è§¦å‘æ¸²æŸ“çš„å˜é‡
- **åœºæ™¯**ï¼šè¾“å…¥æ¡†èšç„¦ã€ä¿å­˜å®šæ—¶å™¨ ID
```jsx
import { useRef } from 'react';

function TextInput() {
  const inputRef = useRef(null);

  const focusInput = () => {
    inputRef.current.focus(); // æ“ä½œ DOM
  };

  return (
    <>
      <input ref={inputRef} type="text" />
      <button onClick={focusInput}>èšç„¦è¾“å…¥æ¡†</button>
    </>
  );
}
```

---

### 8ï¸âƒ£ **useImperativeHandle - æš´éœ²ç»„ä»¶æ–¹æ³•**
- **ä½œç”¨**ï¼šå‘çˆ¶ç»„ä»¶æš´éœ²å­ç»„ä»¶çš„ç‰¹å®šæ–¹æ³•ï¼ˆé…åˆ `forwardRef` ä½¿ç”¨ï¼‰
- **åœºæ™¯**ï¼šçˆ¶ç»„ä»¶éœ€è¦è°ƒç”¨å­ç»„ä»¶æ–¹æ³•ï¼ˆå¦‚è¡¨å•æ ¡éªŒï¼‰
```jsx
useImperativeHandle(ref, () => ({
  validate: () => { /* ... */ }
}));
```

---

### 9ï¸âƒ£ **useLayoutEffect - åŒæ­¥å‰¯ä½œç”¨**
- **ä½œç”¨**ï¼šåœ¨æµè§ˆå™¨ç»˜åˆ¶å‰åŒæ­¥æ‰§è¡Œå‰¯ä½œç”¨ï¼ˆä¼šé˜»å¡æ¸²æŸ“ï¼‰
- **åœºæ™¯**ï¼šéœ€è¦è¯»å– DOM å¸ƒå±€ååŒæ­¥ä¿®æ”¹æ ·å¼
```jsx
useLayoutEffect(() => {
  // åœ¨ DOM æ›´æ–°åï¼Œæµè§ˆå™¨ç»˜åˆ¶å‰æ‰§è¡Œ
});
```

---

### ğŸ”Ÿ **useDebugValue - è°ƒè¯•è‡ªå®šä¹‰ Hook**
- **ä½œç”¨**ï¼šåœ¨ React å¼€å‘è€…å·¥å…·ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰ Hook çš„æ ‡ç­¾
- **åœºæ™¯**ï¼šå¼€å‘è‡ªå®šä¹‰ Hook æ—¶å¢åŠ å¯è¯»æ€§
```jsx
useDebugValue(isOnline ? 'Online' : 'Offline');
```

---

### ğŸ§© **è‡ªå®šä¹‰ Hooks**
- **ä½œç”¨**ï¼šå°†ç»„ä»¶é€»è¾‘æå–ä¸ºå¯å¤ç”¨çš„å‡½æ•°
- **åœºæ™¯**ï¼šå°è£…é€šç”¨é€»è¾‘ï¼ˆå¦‚æ•°æ®è¯·æ±‚ã€è¡¨å•å¤„ç†ï¼‰
```jsx
// è‡ªå®šä¹‰ Hookï¼šè·å–é¼ æ ‡ä½ç½®
function useMousePosition() {
  const [position, setPosition] = useState({ x: 0, y: 0 });
  useEffect(() => {
    const update = (e) => setPosition({ x: e.clientX, y: e.clientY });
    window.addEventListener('mousemove', update);
    return () => window.removeEventListener('mousemove', update);
  }, []);
  return position;
}

// ä½¿ç”¨
const { x, y } = useMousePosition();
```

### ğŸ“Œ Hooks ä½¿ç”¨æ³¨æ„äº‹é¡¹
1ã€æ€§èƒ½ä¼˜åŒ–ï¼š

- ç”¨ `useMemo` ç¼“å­˜å¤æ‚è®¡ç®—
- ç”¨ `useCallback` é¿å…å­ç»„ä»¶ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“

2ã€ä¾èµ–é¡¹æ•°ç»„ï¼š

- useEffect/useMemo/useCallback å¿…é¡»æ­£ç¡®å£°æ˜ä¾èµ–é¡¹

 3ã€é¿å…æ— é™å¾ªç¯ï¼š

```jsx
å¤åˆ¶
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šåœ¨ useEffect ä¸­ä¿®æ”¹ä¾èµ–é¡¹å¯¼è‡´æ— é™å¾ªç¯
useEffect(() => {
  setCount(count + 1);
}, [count]); // ä¾èµ– count åˆä¿®æ”¹ count

// âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°
useEffect(() => {
  setCount(c => c + 1);
}, []); // ä¸å†ä¾èµ– count

```
Hooks æ‰§è¡Œé¡ºåºå¿…é¡»ç¨³å®šï¼š

```jsx
å¤åˆ¶
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šæ¡ä»¶å¼ä½¿ç”¨ Hooks
if (condition) {
  const [value, setValue] = useState(0);
}
```


### ğŸ”„ **Hooks ä¸ç±»ç»„ä»¶å¯¹æ¯”**
| ç±»ç»„ä»¶                  | Hooks ç­‰æ•ˆå†™æ³•              |
|-------------------------|----------------------------|
| `this.state`            | `useState`                 |
| `componentDidMount`     | `useEffect(() => {}, [])`  |
| `componentDidUpdate`    | `useEffect(() => {}, [dep])` |
| `componentWillUnmount`  | `useEffect(() => { return cleanup })` |
| `shouldComponentUpdate` | `React.memo` + `useMemo`   |

--- 

